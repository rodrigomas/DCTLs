// Waveform 

__DEVICE__ float3 transform(int p_Width, int p_Height, int p_X, int p_Y, __TEXTURE__ p_TexR, __TEXTURE__ p_TexG, __TEXTURE__ p_TexB)
{
    // Scale input signal to zoom into shadows (e.g. 2 equals x2 zoom) 
    
    int ZOOM = 1;
    
    // Enable decimal grid markings at left side and bottom (1 = enabled, 0 = off)
    
    int MARKS = 0;
    
    float y = p_Y / (p_Height - 1.0f);
    float x = p_X / (p_Width - 1.0f);
	float colR = 0.0f;
	float colG = 0.0f;
	float colB = 0.0f;
	float lumR = 0.0f;
	float lumG = 0.0f;
	float lumB = 0.0f;
    
    
	for (int i = 0; i < p_Height; i+=1){
	
		lumR = _tex2D(p_TexR, p_X, i);
		lumR *= ZOOM;
		lumR < (1.0f - y) * 1.005f && lumR + 0.005f > (1.0f - y) * 1.005f ? colR += 0.02f : colR;
	}
	
	for (int i = 0; i < p_Height; i+=1){
	
		lumG = _tex2D(p_TexG, p_X, i);
		lumG *= ZOOM;
		lumG < (1.0f - y) * 1.005f && lumG + 0.005f > (1.0f - y) * 1.005f ? colG += 0.02f : colG;
	}
	
	for (int i = 0; i < p_Height; i+=1){
	
		lumB = _tex2D(p_TexB, p_X, i);
		lumB *= ZOOM;
		lumB < (1.0f - y) * 1.005f && lumB + 0.005f > (1.0f - y) * 1.005f ? colB += 0.02f : colB;
	}

	
	float r = MARKS == 1 ? (y > 0.05f && fmod(y, 0.1f) <= 0.002f && p_X < p_Width / 100 ? 0.7f : colR) : colR;
	float g = MARKS == 1 ? (x > 0.05f && fmod(x, 0.1f) <= 0.002f && p_Height - p_Y < p_Height / 100 ? 0.7f : colG) : colG;
	float b = colB;

	

    return make_float3(r, g, b);
}
